(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{591:function(s,n,e){"use strict";e.r(n);var a=e(14),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("###今日目标\n1.修改用户,删除用户")]),s._v(" "),n("p",[s._v("2.推送代码到码云")]),s._v(" "),n("p",[s._v("3.权限列表")]),s._v(" "),n("p",[s._v("4.角色列表")]),s._v(" "),n("p",[s._v("5.分配角色")]),s._v(" "),n("p",[s._v("###1.修改用户信息\nA.为用户列表中的修改按钮绑定点击事件\nB.在页面中添加修改用户对话框，并修改对话框的属性\nC.根据id查询需要修改的用户数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//展示编辑用户的对话框\nasync showEditDialog(id) {\n    //发送请求根据id获取用户信息\n    const { data: res } = await this.$http.get('users/' + id)\n    //判断如果添加失败，就做提示\n    if (res.meta.status !== 200) return this.$message.error('获取用户信息失败')\n    //将获取到的数据保存到数据editForm中\n    this.editForm = res.data\n    //显示弹出窗\n    this.editDialogVisible = true\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("D.在弹出窗中添加修改用户信息的表单并做响应的数据绑定以及数据验证")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 对话框主体区域 --\x3e\n<el-form :model="editForm" :rules="editFormRules" ref="editFormRef" label-width="70px">\n    <el-form-item label="用户名">\n        <el-input v-model="editForm.username" disabled></el-input>\n    </el-form-item>\n    <el-form-item label="邮箱" prop="email">\n        <el-input v-model="editForm.email"></el-input>\n    </el-form-item>\n    <el-form-item label="电话" prop="mobile">\n        <el-input v-model="editForm.mobile"></el-input>\n    </el-form-item>\n</el-form>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("数据绑定以及验证：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//控制修改用户对话框的显示与否\neditDialogVisible: false,\n//修改用户的表单数据\neditForm: {\n    username: '',\n    email: '',\n    mobile: ''\n},\n//修改表单的验证规则对象\neditFormRules: {\n    email: [\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\n        {\n        validator: checkEmail,\n        message: '邮箱格式不正确，请重新输入',\n        trigger: 'blur'\n        }\n    ],\n    mobile: [\n        { required: true, message: '请输入手机号码', trigger: 'blur' },\n        {\n        validator: checkMobile,\n        message: '手机号码不正确，请重新输入',\n        trigger: 'blur'\n        }\n    ]\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("E.监听对话框关闭事件，在对话框关闭之后，重置表单")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<el-dialog title="修改用户" :visible.sync="editDialogVisible" width="50%" @close="editDialogClosed">\n\neditDialogClosed(){\n    //对话框关闭之后，重置表达\n    this.$refs.editFormRef.resetFields()\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("F.在用户点击确定按钮的时候，验证数据成功之后发送请求完成修改")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("editUser() {\n    //用户点击修改表单中的确定按钮之后，验证表单数据\n    this.$refs.editFormRef.validate(async valid => {\n    if (!valid) return this.$message.error('请填写完整用户信息')\n    //发送请求完成修改用户的操作\n    const { data: res } = await this.$http.put(\n        'users/' + this.editForm.id,\n        this.editForm\n    )\n    //判断如果修改失败，就做提示\n    if (res.meta.status !== 200) return this.$message.error('修改用户失败')\n    //修改成功的提示\n    this.$message.success('修改用户成功')\n    //关闭对话框\n    this.editDialogVisible = false\n    //重新请求最新的数据\n    this.getUserList()\n    })\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("###2.删除用户\n在点击删除按钮的时候，我们应该跳出提示信息框，让用户确认要进行删除操作。\n如果想要使用确认取消提示框，我们需要先将提示信息框挂载到vue中。\nA.导入MessageBox组件，并将MessageBox组件挂载到实例。\nVue.prototype.$confirm = MessageBox.confirm\nB.给用户列表中的删除按钮添加事件，并在事件处理函数中弹出确定取消窗,最后再根据id发送删除用户的请求")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("async removeUserById(id){\n    //弹出确定取消框，是否删除用户\n    const confirmResult = await this.$confirm('请问是否要永久删除该用户','删除提示',{\n    confirmButtonText:'确认删除',\n    cancelButtonText:'取消',\n    type:'warning'\n    }).catch(err=>err)\n    //如果用户点击确认，则confirmResult 为'confirm'\n    //如果用户点击取消, 则confirmResult获取的就是catch的错误消息'cancel'\n    if(confirmResult != \"confirm\"){\n        return this.$message.info(\"已经取消删除\")\n    }\n    //发送请求根据id完成删除操作\n    const {data:res} = await this.$http.delete('users/'+id)\n    //判断如果删除失败，就做提示\n    if (res.meta.status !== 200) return this.$message.error('删除用户失败')\n    //修改成功的提示\n    this.$message.success('删除用户成功')\n    //重新请求最新的数据\n    this.getUserList()\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[s._v("###3.推送代码\n创建user子分支，并将代码推送到码云\nA.创建user子分支  git checkout -b user\nB.将代码添加到暂存区 git add .\nC.将代码提交并注释 git commit -m '添加完成用户列表功能'\nD.将本地的user分支推送到码云 git push -u origin user\nE.将user分支代码合并到master:\n切换到master   git checkout master\n合并user       git merge user\nF.将本地master分支的代码推送到码云  git push")]),s._v(" "),n("p",[s._v("创建rights子分支\nA.创建rights子分支 git checkout -b rights\nB.将本地的rights分支推送到码云 git push -u origin rights")]),s._v(" "),n("p",[s._v("###4.权限列表\n####A.添加权限列表路由\n创建权限管理组件（Rights.vue），并在router.js添加对应的路由规则")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import Rights from './components/power/Rights.vue'\n......\n      path: '/home', component: Home, redirect: '/welcome', children: [\n        { path: \"/welcome\", component: Welcome },\n        { path: \"/users\", component: Users },\n        { path: \"/rights\", component: Rights }\n      ]\n......\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("####B.添加面包屑导航\n在Rights.vue中添加面包屑组件展示导航路径\n####C.显示数据\n在data中添加一个rightsList数据，在methods中提供一个getRightsList方法发送请求获取权限列表数据，在created中调用这个方法获取数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<el-table :data="rightsList" stripe>\n    <el-table-column type="index"></el-table-column>\n    <el-table-column label="权限名称" prop="authName"></el-table-column>\n    <el-table-column label="路径" prop="path"></el-table-column>\n    <el-table-column label="权限等级" prop="level">\n        <template slot-scope="scope"> \n            <el-tag v-if="scope.row.level === 0">一级权限</el-tag>\n            <el-tag v-if="scope.row.level === 1" type="success">二级权限</el-tag>\n            <el-tag v-if="scope.row.level === 2" type="warning">三级权限</el-tag>\n        </template>\n    </el-table-column>\n</el-table>\n<script>\nexport default {\n    data(){\n        return {\n            //列表形式的权限\n            rightsList:[]\n        }\n    },\n    created(){\n        this.getRightsList();\n    },\n    methods:{\n        async getRightsList(){\n            const {data:res} = await this.$http.get(\'rights/list\')\n            //如果返回状态为异常状态则报错并返回\n            if (res.meta.status !== 200)\n                return this.$message.error(\'获取权限列表失败\')\n            //如果返回状态正常，将请求的数据保存在data中\n            this.rightsList = res.data\n        }\n    }\n}\n<\/script>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("p",[s._v("###5.角色列表\n####A.添加角色列表路由\n添加角色列表子组件（power/Roles.vue），并添加对应的规则")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('path: \'/home\', component: Home, redirect: \'/welcome\', children: [\n        { path: "/welcome", component: Welcome },\n        { path: "/users", component: Users },\n        { path: "/rights", component: Rights },\n        { path: "/roles", component: Roles  }\n      ]\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("####B.添加面包屑导航\n在Roles.vue中添加面包屑组件展示导航路径\n####C.显示数据\n在data中添加一个roleList数据，在methods中提供一个getRoleList方法发送请求获取权限列表数据，在created中调用这个方法获取数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 角色列表区域 --\x3e\n\x3c!-- row-key="id" 是2019年3月提供的新特性，\nif there\'s nested data, rowKey is required.\n如果这是一个嵌套的数据，rowkey 是必须添加的属性 --\x3e\n<el-table row-key="id" :data="roleList" border>\n    \x3c!-- 添加展开列 --\x3e\n    <el-table-column type="expand"></el-table-column>\n    <el-table-column type="index"></el-table-column>\n    <el-table-column label="角色名称" prop="roleName"></el-table-column>\n    <el-table-column label="角色描述" prop="roleDesc"></el-table-column>\n    <el-table-column label="操作" width="300px">\n        <template slot-scope="scope"> \n            <el-button size="mini" type="primary" icon="el-icon-edit">编辑</el-button>\n            <el-button size="mini" type="danger" icon="el-icon-delete">删除</el-button>\n            <el-button size="mini" type="warning" icon="el-icon-setting">分配权限</el-button>\n        </template>\n    </el-table-column>\n</el-table>\n\n<script>\nexport default {\n    data(){\n        return {\n            roleList:[]\n        }\n    },created(){\n        this.getRoleList();\n    },methods:{\n        async getRoleList(){\n            const {data:res} = await this.$http.get(\'roles\')\n            //如果返回状态为异常状态则报错并返回\n            // if (res.meta.status !== 200)\n            //     return this.$message.error(\'获取角色列表失败\')\n            // //如果返回状态正常，将请求的数据保存在data中\n            // this.roleList = res.data\n            console.log(res.data)\n            this.roleList = res.data;\n        }\n    }\n}\n<\/script>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("p",[s._v("####D.补充说明\n之前学习过类似的添加角色，删除角色，编辑角色请参照之前编写过的代码还有接口文档完成效果。")]),s._v(" "),n("p",[s._v("####E.生成权限列表\n使用三重嵌套for循环生成权限下拉列表")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 添加展开列 --\x3e\n<el-table-column type="expand">\n    <template slot-scope="scope">\n        <el-row :class="[\'bdbottom\',i1===0?\'bdtop\':\'\']" v-for="(item1,i1) in scope.row.children" :key="item1.id">\n            \x3c!-- 渲染一级权限 --\x3e\n            <el-col :span="5">\n                <el-tag>\n                    {{item1.authName}}\n                </el-tag>\n                <i class="el-icon-caret-right"></i>\n            </el-col>\n            \x3c!-- 渲染二，三级权限 --\x3e\n            <el-col :span="19">\n                \x3c!-- 通过for循环嵌套渲染二级权限  --\x3e\n                <el-row :class="[i2===0?\'\':\'bdtop\' ]" v-for="(item2,i2) in item1.children" :key="item2.id">\n                    <el-col :span="6">\n                        <el-tag type="success">{{item2.authName}}</el-tag>\n                        <i class="el-icon-caret-right"></i>\n                    </el-col>\n                    <el-col :span="18">\n                        <el-tag type="warning" v-for="(item3) in item2.children" :key="item3.id">\n                            {{item3.authName}}\n                        </el-tag>\n                    </el-col>\n                </el-row>\n            </el-col>\n        </el-row>\n    </template>\n</el-table-column>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("p",[s._v("####F.美化样式\n通过设置global.css中的#app样式min-width:1366px 解决三级权限换行的问题\n，通过给一级权限el-row添加display:flex,align-items:center的方式解决一级权限垂直居中的问题，二级权限也类似添加，因为需要给多个内容添加，可以将这个样式设置为一个.vcenter{display:flex;align-items:center}")]),s._v(" "),n("p",[s._v("####G.添加权限删除功能\n给每一个权限的el-tag添加closable属性，是的权限右侧出现“X”图标\n再给el-tag添加绑定close事件处理函数removeRightById(scope.row,item1.id)\nremoveRightById(scope.row,item2.id)\nremoveRightById(scope.row,item3.id)")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("async removeRightById(role,rightId){\n    //弹窗提示用户是否要删除\n    const confirmResult = await this.$confirm('请问是否要删除该权限','删除提示',{\n        confirmButtonText:'确认删除',\n        cancelButtonText:'取消',\n        type:'warning'\n    }).catch(err=>err)\n    //如果用户点击确认，则confirmResult 为'confirm'\n    //如果用户点击取消, 则confirmResult获取的就是catch的错误消息'cancel'\n    if(confirmResult != \"confirm\"){\n        return this.$message.info(\"已经取消删除\")\n    }\n\n    //用户点击了确定表示真的要删除\n    //当发送delete请求之后，返回的数据就是最新的角色权限信息\n    const {data:res} = await this.$http.delete(`roles/${role.id}/rights/${rightId}`)\n    if (res.meta.status !== 200)\n        return this.$message.error('删除角色权限失败')\n\n    //无需再重新加载所有权限\n    //只需要对现有的角色权限进行更新即可\n    role.children = res.data\n    // this.getRoleList();\n\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("p",[s._v('####H.完成权限分配功能\n先给分配权限按钮添加事件\n<el-button size="mini" type="warning" icon="el-icon-setting" @click="showSetRightDialog">分配权限'),s._v("\n在showSetRightDialog函数中请求权限树数据并显示对话框")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("async showSetRightDialog() {\n    //当点击分配权限按钮时，展示对应的对话框\n    this.setRightDialogVisible = true;\n    //获取所有权限的数据\n    const {data:res} = await this.$http.get('rights/tree')\n    //如果返回状态为异常状态则报错并返回\n    if (res.meta.status !== 200)\n        return this.$message.error('获取权限树失败')\n    //如果返回状态正常，将请求的数据保存在data中\n    this.rightsList = res.data\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("添加分配权限对话框，并添加绑定数据setRightDialogVisible\n"),s._v(" "),n("el-dialog",{attrs:{title:"分配权限",visible:s.setRightDialogVisible,width:"50%"},on:{"update:visible":function(n){s.setRightDialogVisible=n}}},[n("span",[s._v("这是一段信息")]),s._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s._v('\n<el-button @click="setRightDialogVisible = false">取 消'),s._v('\n<el-button type="primary" @click="setRightDialogVisible = false">确 定')])])],1),s._v(" "),n("p",[s._v("####I.完成树形结构弹窗\n在element.js中引入Tree，注册Tree")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\x3c!-- 分配权限对话框 --\x3e\n<el-dialog title=\"分配权限\" :visible.sync=\"setRightDialogVisible\" width=\"50%\" @close=\"setRightDialogClose\">\n    \x3c!-- 树形组件\n    show-checkbox:显示复选框\n    node-key:设置选中节点对应的值\n    default-expand-all:是否默认展开所有节点\n    :default-checked-keys 设置默认选中项的数组\n    ref:设置引用 --\x3e\n    <el-tree :data=\"rightsList\" :props=\"treeProps\" show-checkbox node-key=\"id\" default-expand-all :default-checked-keys=\"defKeys\" ref=\"treeRef\"></el-tree>\n    <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"setRightDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"allotRights\">确 定</el-button>\n    </span>\n</el-dialog>\n\n<script>\nexport default {\n  data() {\n    return {\n      //角色列表数据\n      roleList: [],\n      //控制分配权限对话框的显示\n      setRightDialogVisible: false,\n      //权限树数据\n      rightsList: [],\n      //树形控件的属性绑定对象\n      treeProps: {\n        //通过label设置树形节点文本展示authName\n        label: 'authName',\n        //设置通过children属性展示子节点信息\n        children: 'children'\n      },\n      //设置树形控件中默认选中的内容\n      defKeys: [],\n      //保存正在操作的角色id\n      roleId:''\n    }\n  },\n  created() {\n    this.getRoleList()\n  },\n  methods: {\n    async getRoleList() {\n      const { data: res } = await this.$http.get('roles')\n      //如果返回状态为异常状态则报错并返回\n      if (res.meta.status !== 200)\n        return this.$message.error('获取角色列表失败')\n      //如果返回状态正常，将请求的数据保存在data中\n      // this.roleList = res.data\n      console.log(res.data)\n      this.roleList = res.data\n    },\n    async removeRightById(role, rightId) {\n      //弹窗提示用户是否要删除\n      const confirmResult = await this.$confirm(\n        '请问是否要删除该权限',\n        '删除提示',\n        {\n          confirmButtonText: '确认删除',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).catch(err => err)\n      //如果用户点击确认，则confirmResult 为'confirm'\n      //如果用户点击取消, 则confirmResult获取的就是catch的错误消息'cancel'\n      if (confirmResult != 'confirm') {\n        return this.$message.info('已经取消删除')\n      }\n\n      //用户点击了确定表示真的要删除\n      //当发送delete请求之后，返回的数据就是最新的角色权限信息\n      const { data: res } = await this.$http.delete(\n        `roles/${role.id}/rights/${rightId}`\n      )\n      if (res.meta.status !== 200)\n        return this.$message.error('删除角色权限失败')\n\n      //无需再重新加载所有权限\n      //只需要对现有的角色权限进行更新即可\n      role.children = res.data\n      // this.getRoleList();\n    },\n    async showSetRightDialog(role) {\n      //将role.id保存起来以供保存权限时使用\n      this.roleId = role.id;  \n      //获取所有权限的数据\n      const { data: res } = await this.$http.get('rights/tree')\n      //如果返回状态为异常状态则报错并返回\n      if (res.meta.status !== 200) return this.$message.error('获取权限树失败')\n      //如果返回状态正常，将请求的数据保存在data中\n      this.rightsList = res.data\n\n      //调用getLeafKeys进行递归，将三级权限添加到数组中\n      this.getLeafKeys(role, this.defKeys)\n      //当点击分配权限按钮时，展示对应的对话框\n      this.setRightDialogVisible = true\n      console.log(this.defKeys)\n    },\n    getLeafKeys(node, arr) {\n      //该函数会获取到当前角色的所有三级权限id并添加到defKeys中\n      //如果当前节点不包含children属性，则表示node为三级权限\n      if (!node.children) {\n        return arr.push(node.id)\n      }\n      //递归调用\n      node.children.forEach(item => this.getLeafKeys(item, arr))\n    },\n    setRightDialogClose() {\n      //当用户关闭树形权限对话框的时候，清除掉所有选中状态\n      this.defKeys = []\n    },\n    async allotRights() {\n      //当用户在树形权限对话框中点击确定，将用户选择的\n      //权限发送请求进行更新\n\n      //获取所有选中及半选的内容\n      const keys = [\n        ...this.$refs.treeRef.getCheckedKeys(),\n        ...this.$refs.treeRef.getHalfCheckedKeys()\n      ]\n      //将数组转换为 , 拼接的字符串\n      const idStr = keys.join(',')\n\n      //发送请求完成更新\n      const { data: res } = await this.$http.post(\n        `roles/${this.roleId}/rights`,\n        { rids:idStr }\n      )\n      if (res.meta.status !== 200)\n        return this.$message.error('分配权限失败')\n\n      this.$message.success(\"分配权限成功\")\n      this.getRoleList();\n      //关闭对话框\n      this.setRightDialogVisible = false;\n    }\n  }\n}\n<\/script>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br")])]),n("p",[s._v("###6.分配角色\n打开Users.vue，完成分配角色的功能\nA.添加分配角色对话框")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 分配角色对话框 --\x3e\n<el-dialog title="分配角色" :visible.sync="setRoleDialogVisible" width="50%">\n    <div>\n    <p>当前的用户:{{userInfo.username}}</p>\n    <p>当前的角色:{{userInfo.role_name}}</p>\n    <p>分配新角色:</p>\n    </div>\n    <span slot="footer" class="dialog-footer">\n    <el-button @click="setRoleDialogVisible = false">取 消</el-button>\n    <el-button type="primary" @click="setRoleDialogVisible = false">确 定</el-button>\n    </span>\n</el-dialog>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("B.给分配角色按钮添加点击事件，点击之后弹出一个对话框进行角色分配")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 分配角色 --\x3e\n<el-tooltip class="item" effect="dark" content="分配角色" placement="top" :enterable="false">\n    <el-button type="warning" icon="el-icon-setting" size=\'mini\' @click="setRole(scope.row)"></el-button>\n</el-tooltip>\n\ndata(){\n    ......\n    //控制显示分配角色对话框\n    setRoleDialogVisible:false,\n    //保存正在操作的那个用户信息\n    userInfo:{},\n    //保存所有的角色信息\n    rolesList:[],\n    //保存用户选中的角色id\n    selectedRoleId:\'\'\n},\nmethods:{\n    ......\n    async setRole( userInfo ){\n      //保存起来以供后续使用\n      this.userInfo = userInfo;\n      //获取所有的角色信息，以备下拉列表使用\n      //发送请求根据id完成删除操作\n      const { data: res } = await this.$http.get(\'roles\')\n      //判断如果删除失败，就做提示\n      if (res.meta.status !== 200) return this.$message.error(\'获取角色列表失败\')\n      \n      this.rolesList = res.data;\n      //展示分配角色对话框\n      this.setRoleDialogVisible = true;\n\n      \n    }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br")])]),n("p",[s._v("C.在element.js中引入Select，Option，注册Select，Option")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 角色选择下拉框\nv-model：设置用户选中角色之后的id绑定数据\n--\x3e\n<el-select v-model="selectedRoleId" placeholder="请选择角色">\n\x3c!-- :label 显示文本，:value 选中值 --\x3e\n<el-option v-for="item in rolesList" :key="item.id" :label="item.roleName" :value="item.id">\n</el-option>\n</el-select>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("D.当用户点击对话框中的确定之后，完成分配角色的操作")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\x3c!-- 分配角色对话框 --\x3e\n<el-dialog title="分配角色" :visible.sync="setRoleDialogVisible" width="50%" @close="setRoleDialogClosed">\n    <div>\n    <p>当前的用户:{{userInfo.username}}</p>\n    <p>当前的角色:{{userInfo.role_name}}</p>\n    <p>分配新角色:\n        \x3c!-- 角色选择下拉框\n        v-model：设置用户选中角色之后的id绑定数据\n        --\x3e\n        <el-select v-model="selectedRoleId" placeholder="请选择角色">\n        \x3c!-- :label 显示文本，:value 选中值 --\x3e\n        <el-option v-for="item in rolesList" :key="item.id" :label="item.roleName" :value="item.id">\n        </el-option>\n        </el-select>\n    </p>\n    </div>\n    <span slot="footer" class="dialog-footer">\n    <el-button @click="setRoleDialogVisible = false">取 消</el-button>\n    <el-button type="primary" @click="saveRoleInfo">确 定</el-button>\n    </span>\n</el-dialog>\n\n\nmethods:{\n    .......\n    async saveRoleInfo(){\n      //当用户点击确定按钮之后\n      //判断用户是否选择了需要分配的角色\n      if(!this.selectedRoleId){\n        return this.$message.error(\'请选择需要分配的角色\')\n      }\n      //发送请求完成分配角色的操作\n      const {data:res} = await this.$http.put(`users/${this.userInfo.id}/role`,{rid:this.selectedRoleId})\n\n      //判断如果删除失败，就做提示\n      if (res.meta.status !== 200)\n        return this.$message.error(\'分配角色失败\')\n\n      this.$message.success(\'分配角色成功\')\n      this.getUserList();\n      //关闭对话框\n      this.setRoleDialogVisible = false\n    },\n    setRoleDialogClosed(){\n      //当关闭对话框的时候，重置下拉框中的内容\n      this.selectedRoleId = \'\'\n      this.userInfo = {}\n    }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br")])]),n("p",[s._v("###7.将代码推送到码云\nA.将代码推送到暂存区 git add .\nB.将代码提交到仓库 git commit -m '完成了权限功能开发'\nC.将rights分支代码推送到码云 git push\nD.将代码合并到master\ngit checkout master\ngit merge rights\nE.将master代码推送到码云\ngit push")])])}),[],!1,null,null,null);n.default=t.exports}}]);